
<?R
    tab = expand.grid(PeriodX=c(16,32,64,128,256))

    dir_name <- "batch_laplace_test"
    dir.create(dir_name)
    tab$name = paste0(dir_name,"/laplace_template", "_nx_",tab$PeriodX,"_ny_",tab$PeriodX+2)
    tab$xml = paste0(tab$name,".xml")


    write.csv(tab, "laplace_template.csv", row.names=FALSE)
    for (i in 1:nrow(tab)) {
        attach(tab[i,,drop=FALSE])
        print(xml)
        sink(xml) # save to a .xml file
?>

<!-- <CLBConfig version="2.0" output="/net/scratch/people/plgmuaddieb/output/bubble_cm_template/"> -->
<?xml version="1.0"?>
<CLBConfig version="2.0" output="output/laplace_template/">
    <Geometry nx="<?%f PeriodX ?>" ny="<?%f PeriodX +2 ?>" >
      <CM><Box /></CM>    
      <!-- <Smoothing><Box /></Smoothing>  -->    

        <HeaterDirichletTemperature  name="dirichlet_cold"> 
            <Box nx="1"/>
            <Box dx="-1"/>
            <Box ny="2"/>
        </HeaterDirichletTemperature>

        <HeaterDirichletTemperature  name="dirichlet_hot"> 
          <Box dy="-1"/>
        </HeaterDirichletTemperature>

         <Wall mask="ALL" name="border" >
           <Box ny="1"/>
                <!-- <Box dy="-1"/>  -->
        </Wall>
    </Geometry>
    <Model>
        <Params
            k="0.1666666" 
            cp="1.0"

            InitTemperature="0.0"

            InitTemperature-dirichlet_hot="1.0"
            InitTemperature-dirichlet_cold="0.0"
            />
        <Params />
        <Params PeriodX="<?%f PeriodX ?>"/>
        <Params PeriodY="<?%f PeriodX ?>"/>
    </Model>

<!-- 
    <Solve Iterations="25" output="output/"> <VTK Iterations="10"/> </Solve>
<Geometry>
  <None mask="ADDITIONALS">
    <Box nx="512" ny="100" nz="100"/>
  </None>
</Geometry> -->

<!-- <Solve Iterations="10" output="output/"> <VTK Iterations="1"/> </Solve> -->
<Failcheck Iterations="10000" nx="<?%f PeriodX ?>" ny="<?%f PeriodX +2 ?>" />
<TXT Iterations="10000" what="T,U"/>
<Log Iterations="10000"/>
<Solve Iterations="100000" output="output/"> <VTK Iterations="10000"/> </Solve>
</CLBConfig>

<?R
    sink()
    detach()
}
?>
