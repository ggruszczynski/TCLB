<!-- 
See
`Direct numerical simulation of heat transfer from a cylinder immersed in the production and decay regions of grid-element turbulence`
by I. Paul, G. Papadakis, J.C. Vassilicos
J. Fluid. Mech. vol. 847, pp452-488, 2018
 -->

<?xml version="1.0"?>
<CLBConfig version="2.0" output="/net/scratch/people/plgmuaddieb/output/JFM_DDF/diri/">
    <Geometry nx="300" ny="192" nz="192">
        <CM_HIGHER><Box/></CM_HIGHER>
        <IBB name="border" >
	       <STL file="WIP/Benchmarks/JFM/jfm_grid_old.stl" scale="420.819445" Xrot="0d" x="29.119064" y="0.595264" z="0.595264" side="surface"/>



   	    </IBB>
        <WVelocity name="Inlet"><Box nx="1"/></WVelocity>
        <EPressure name="Outlet"><Box dx="-1"/></EPressure>
        <HeaterDirichletTemperatureEQ mask="COLLISION" name="dirichlet"> 
          <Cylinder dx="207" dy="87" nx="18" ny="18" nz="192"/> <!-- turbulence production region -->
        </HeaterDirichletTemperatureEQ>  
       <FluxMeasurment>
            <Cylinder dx="207" dy="87" nx="18" ny="18" nz="192"/>
            <!-- <Outlet/> -->
        </FluxMeasurment>
    </Geometry>
    <Model>
        <Params
          InitTemperature="10"
          InitTemperature-inlet="10"
          InitTemperature-outlet="10"
          InitTemperature-dirichlet="11"


            />
        <Params/>

      <Params Velocity="0.05"
              Velocity-Inlet="0.05"
              nu="0.00181132075"

              conductivity="0.03"
              conductivity_buffer="0.1"

              h_stability_enhancement="1."
              cp="1"
              material_density="1"
              />



    </Model>
<!--     <Solve Iterations="10"/>
    <Failcheck Iterations="2000" nx="10" ny="192" nz="192" />
    <Solve Iterations="500000" > <VTK Iterations="50000" what="T,U,Rho"/> </Solve>
    <SaveMemoryDump Iterations="250000" file="test.tclbdump"/>
    <Average><Solve Iterations="400000"/></Average>
    <Solve Iterations="100000" /> <VTK Iterations="50000" what="T,U,Rho"/> </Solve> -->

    <Solve Iterations="5"> <VTK Iterations="1"/></Solve>
    <Solve Iterations="5000" > <VTK Iterations="100" what="T,U,Rho"/> </Solve>
    <Failcheck Iterations="2000" nx="10" ny="192" nz="192" />
    <Average><Solve Iterations="1000"/></Average>
    <Solve Iterations="5000" > <VTK Iterations="100" what="T,U,Rho"/> </Solve>
  </CLBConfig>
