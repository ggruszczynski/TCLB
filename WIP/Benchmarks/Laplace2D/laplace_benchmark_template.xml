
<?R
    tab = expand.grid(PeriodX=c(32,64,128))

    dir_name <- "batch_laplace_benchmark"
    dir.create(dir_name)
    tab$name = paste0(dir_name,"/laplace_template", "_nx_",tab$PeriodX,"_ny_",tab$PeriodX+2)
    tab$xml = paste0(tab$name,".xml")


    write.csv(tab, "laplace_template.csv", row.names=FALSE)
    for (i in 1:nrow(tab)) {
        attach(tab[i,,drop=FALSE])
        print(xml)
        sink(xml) # save to a .xml file
?>

<!-- <CLBConfig version="2.0" output="/net/scratch/people/plgmuaddieb/output/laplace_template/"> -->
<?xml version="1.0"?>
<CLBConfig version="2.0" output="output/laplace_template/">
    <Geometry nx="<?%f PeriodX ?>" ny="<?%f PeriodX +2 ?>" >
      <CM><Box /></CM>    

         <Wall mask="ALL" name="border" >
        	<Box ny="1"/>
			<Box dy="-1"/> 
        </Wall>

        <HeaterDirichletTemperature mask="COLLISION"  name="dirichlet_hot"> 
        	<Box dy="-2"/>
        </HeaterDirichletTemperature>

        <HeaterDirichletTemperature mask="COLLISION" name="dirichlet_cold"> 
            <Box nx="1"/>
            <Box dx="-1"/>
            <Box ny="2"/>
        </HeaterDirichletTemperature>

    </Geometry>
    <Model>
        <Params
            k="0.1666666" 
            cp="1.0"

            InitTemperature="0.0"

            InitTemperature-dirichlet_hot="1.0"
            InitTemperature-dirichlet_cold="0.0"
            />
        <Params />
        <Params PeriodX="<?%f PeriodX ?>"/>
        <Params PeriodY="<?%f PeriodX ?>"/>
    </Model>

<Failcheck Iterations="50000" nx="<?%f PeriodX ?>" ny="<?%f PeriodX +2 ?>" />
<TXT Iterations="50000" what="T,U"/>
<Log Iterations="50000"/>
<Solve Iterations="250000"> <VTK Iterations="50000"/> </Solve>
</CLBConfig>

<?R
    sink()
    detach()
}
?>
