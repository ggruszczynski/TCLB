<?R
    tab = expand.grid(sizer=c(1,2,4,8), k_outer_material=c(0.01,0.001))

    dir_name <- "batch_ruraWrurze_variable_k"
    dir.create(dir_name)

    tab$name = paste0("k_outer_", tab$k_outer_material, "_size_",32*tab$sizer, "lu")
    tab$xml = paste0(paste0(dir_name,"/",tab$name),".xml")
    tab$output = paste0(paste0("output/",dir_name,"/",tab$name,"/"))

    # tab$output = paste0(paste0("/net/scratch/people/plgmuaddieb/output/",dir_name,"/",tab$name,"/"))

    write.csv(tab, "ruraWrurze_variable_k_template.csv", row.names=FALSE)
    for (i in 1:nrow(tab)) {
        attach(tab[i,,drop=FALSE])
        print(xml)
        sink(xml) # save to a .xml file
?>

<!-- 
	W = kg⋅m2⋅s−3 
	J = kg⋅m2⋅s−2
-->
<?xml version="1.0"?>
<CLBConfig version="2.0" output="<?%s output ?>">
	<Units>
    <Params size="1m" gauge="<?%f sizer ?>"/>
<!--     
    <Params conductivity="1.0W/m/K" gauge="1E-0"/> 
	<Params cp="1.0J/kg/K" gauge="1E-0"/>
	<Params	material_density="1.0kg/m3" gauge="1E-0"/> -->
  </Units>
	<Geometry nx="32m" ny="32m" >
      <CM><Box/></CM>    
     	<HeaterDirichletTemperature name="dirichlet_hot"> 
            <Box />
        </HeaterDirichletTemperature>

		<None mask="ADDITIONALS_HEAT">
			<Sphere ny="30m" nx="30m" dx="1m" dy="1m"/>
		</None>

        <HeaterDirichletTemperature name="dirichlet_cold"> 
        	<Sphere ny="8m" nx="8m" dx="12m" dy="12m"/>
        </HeaterDirichletTemperature>

      	<DarcySolid name="darcy_solid_region">
        	<Sphere ny="20m" nx="20m" dx="6m" dy="6m"/>
      	</DarcySolid>
        <None name="material_A_region">
        	<Sphere ny="20m" nx="20m" dx="6m" dy="6m"/>
        </None>        
	</Geometry>
    <Model>
	    <Params
	    	h_stability_enhancement="1."

	        conductivity="<?%f k_outer_material ?>" 
	        cp="1"
			material_density="1"

			conductivity-material_A_region="0.1"
			cp-material_A_region="1"
			material_density-material_A_region="1"

	        InitTemperature="0.0"
	        InitTemperature-dirichlet_hot="1.0"
	        InitTemperature-dirichlet_cold="0.0"
	        />
	    <Params />
	        <!-- <Params GravitationX="-1.0E-5" /> -->
    </Model> 

<!-- <Solve Iterations="10" > <VTK Iterations="1"/> </Solve> -->
	<Failcheck Iterations="10000" nx="32m" ny="32m" />
	<TXT Iterations="100000" what="T,U" />
	<Log Iterations="100000" />
	<Solve Iterations="500000">
		<VTK Iterations="100000" />
	</Solve>
</CLBConfig>


<?R
    sink()
    detach()
}
?>
