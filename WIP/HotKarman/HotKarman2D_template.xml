
<?R
    tab = expand.grid(nu=c(3e-02,3e-03,3e-04), k=c(3e-01,3e-02,3e-03,3e-04,3e-5))

    dir_name <- "batch_HotKarman2D"
    dir.create(dir_name)
    # tab$name = paste0(dir_name,"/HotKarman2D_template", "_nu_",tab$nu,"_k_",tab$k)
    # tab$xml = paste0(tab$name,".xml")
    tab$name = paste0("HotKarman2D_template", "_nu_",tab$nu,"_k_",tab$k)
    tab$xml = paste0(paste0(dir_name,"/",tab$name),".xml")
    tab$output = paste0(paste0("output/",dir_name,"/",tab$name,"/"))
    # tab$output = paste0(paste0("/net/scratch/people/plgmuaddieb/output/",dir_name,"/",tab$name,"/"))

    write.csv(tab, "HotKarman2D_template.csv", row.names=FALSE)
    for (i in 1:nrow(tab)) {
        attach(tab[i,,drop=FALSE])
        print(xml)
        sink(xml) # save to a .xml file
?>

<?xml version="1.0"?>
<!-- <CLBConfig version="2.0" output="output/HotKarman2D_template/"> -->
<CLBConfig version="2.0" output="<?%s output ?>">
<!-- <CLBConfig version="2.0" output="/net/scratch/people/plgmuaddieb/output/HotKarman2D_template/"> -->q
    <Geometry nx="1000" ny="150">
      <CM><Box /></CM>    
        <CM><Box/></CM>
        <WVelocity><Inlet/></WVelocity>
        <!-- <EPressure><Outlet/></EPressure> -->
        <!-- <EConvect><Outlet/></EConvect> -->
        <ENeumann><Outlet/></ENeumann>

        <Wall mask="ALL">
            <!-- <Channel/> -->
            <Cylinder dx="285" dy="60" nx="30" ny="30"/>
        </Wall>

        <HeaterDirichletTemperature  name="dirichlet_hot"> 
          <Cylinder dx="285" dy="60" nx="30" ny="30"/>
        </HeaterDirichletTemperature>  

        <MeasurmentArea>
            <!-- <Cylinder dx="285" dy="60" nx="30" ny="30"/> -->
            <Outlet/>
        </MeasurmentArea>
    </Geometry>

    <Model>
        <Params
            InitTemperature="0"
            InitTemperature-dirichlet_hot="1"
            InitTemperature-dirichlet_cold="0"
            />
        <Params/>

        <Params
            nu="<?%f nu ?>"
            conductivity="<?%f k ?>"

            h_stability_enhancement="1."
            cp="1"
            material_density="1"
            />
        <Params/>
        <Params VelocityX="1.0E-02" />
    </Model>

<Failcheck Iterations="1000" nx="1000" ny="150"/>
<TXT Iterations="50000" what="T,U"/>
<Log Iterations="1000"/>
<Solve Iterations="750000"> <VTK Iterations="500"/> </Solve>
</CLBConfig>

<?R
    sink()
    detach()
}
?>
